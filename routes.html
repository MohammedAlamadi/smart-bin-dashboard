<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Smart Routes - Smart Waste</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

  <!-- Icons -->
  <script src="https://unpkg.com/phosphor-icons"></script>

  <!-- Leaflet (real map) -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Poppins", sans-serif;
    }
    body {
      background: #050815;
      color: #f9fafb;
      min-height: 100vh;
    }

    /* Navbar (same as live.html) */
    nav {
      position: fixed;
      top: 0;
      width: 100%;
      padding: 18px 40px;
      background: rgba(5, 8, 21, 0.9);
      backdrop-filter: blur(10px);
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 999;
      transition: 0.3s;
    }
    nav.scrolled {
      background: rgba(5, 8, 21, 1);
    }
    nav .logo {
      font-size: 1.5rem;
      font-weight: 700;
    }
    nav ul {
      display: flex;
      gap: 30px;
      list-style: none;
    }
    nav ul li a {
      text-decoration: none;
      color: #e5e7eb;
      font-weight: 400;
      font-size: 0.95rem;
      transition: 0.2s;
    }
    nav ul li a:hover {
      color: #4ae3ff;
    }

    /* Layout */
    .page {
      padding: 110px 8% 40px;
    }
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      gap: 20px;
      flex-wrap: wrap;
      margin-bottom: 25px;
    }
    .page-header h1 {
      font-size: 2.4rem;
    }
    .page-header p {
      opacity: 0.8;
      max-width: 560px;
      font-size: 0.98rem;
    }
    .timestamp {
      font-size: 0.9rem;
      opacity: 0.7;
      text-align: right;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 20px;
      margin-bottom: 25px;
    }

    /* top-level spacing so big cards don’t touch */
    .page > .grid,
    .page > .card {
      margin-bottom: 25px;
    }

    .card {
      background: radial-gradient(circle at top left, #1f2937, #030712);
      border-radius: 16px;
      padding: 20px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 12px 30px rgba(0,0,0,0.45);
      border: 1px solid rgba(148, 163, 184, 0.25);
      animation: floatIn 0.6s ease-out;
    }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    .card-title {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .card-title i {
      font-size: 26px;
    }
    .badge {
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.75rem;
      letter-spacing: 0.03em;
      text-transform: uppercase;
      border: 1px solid rgba(148, 163, 184, 0.6);
    }

    .main-value {
      font-size: 2rem;
      font-weight: 700;
      margin: 4px 0;
    }
    .secondary {
      font-size: 0.9rem;
      opacity: 0.8;
    }

    .pill {
      display: inline-block;
      margin-top: 6px;
      font-size: 0.78rem;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: rgba(15, 23, 42, 0.8);
      opacity: 0.9;
    }

    .tag {
      display: inline-block;
      margin-top: 8px;
      font-size: 0.8rem;
      padding: 4px 9px;
      border-radius: 999px;
      background: rgba(15, 118, 110, 0.25);
      color: #a5f3fc;
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 12px;
    }
    .chip {
      font-size: 0.78rem;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(55, 65, 81, 0.9);
      opacity: 0.9;
    }
    .chip.good {
      background: rgba(22, 163, 74, 0.25);
      border-color: #22c55e;
      color: #bbf7d0;
    }

    .list {
      margin-top: 10px;
      font-size: 0.9rem;
      opacity: 0.9;
    }
    .list li {
      margin-bottom: 6px;
      list-style: none;
      position: relative;
      padding-left: 16px;
    }
    .list li::before {
      content: "";
      position: absolute;
      left: 0;
      top: 8px;
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #4ae3ff;
    }

    .two-cols {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 20px;
      margin-top: 15px;
    }

    .timeline {
      margin-top: 10px;
    }
    .timeline-step {
      display: flex;
      gap: 10px;
      background: rgba(15, 23, 42, 0.95);
      border-radius: 10px;
      padding: 8px 10px;
      font-size: 0.86rem;
      margin-bottom: 8px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      opacity: 0.9;
    }
    .step-num {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(56, 189, 248, 0.18);
      border: 1px solid rgba(56, 189, 248, 0.8);
      font-size: 0.75rem;
    }

    .subtitle {
      font-size: 0.9rem;
      opacity: 0.8;
      margin-top: 6px;
    }

    /* Real map wrapper */
    .map-wrapper {
      margin-top: 12px;
    }
    .map-box {
      border-radius: 14px;
      background: #020617;
      border: 1px solid rgba(55, 65, 81, 0.9);
      overflow: hidden;
      height: 320px;
    }
    #city-map {
      width: 100%;
      height: 100%;
    }

    @keyframes floatIn {
      from { opacity: 0; transform: translateY(16px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    @media (max-width: 800px) {
      nav {
        padding: 14px 18px;
      }
      nav ul {
        gap: 14px;
        font-size: 0.85rem;
      }
      .page {
        padding: 90px 16px 30px;
      }
      .page-header h1 {
        font-size: 1.9rem;
      }
    }
  </style>
</head>

<body>
  <!-- Navbar -->
  <nav id="navbar">
    <div class="logo">SmartWaste</div>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="overview.html">System Overview</a></li>
      <li><a href="live.html">Live Dashboard</a></li>
      <li><a href="routes.html">Smart Routes</a></li>
      <li><a href="food.html">Food → Energy</a></li>
      <li><a href="sustainability.html">Sustainability</a></li>
      <li><a href="sorting.html">AI Sorting</a></li>
      <li><a href="contact.html">Team</a></li>
    </ul>
  </nav>

  <main class="page">
    <div class="page-header">
      <div>
        <h1>Smart Routes & Collection Optimization</h1>
        <p>
          Instead of visiting every bin on a fixed schedule, SmartWaste only
          sends trucks to the bins that actually need collection. This page
          explains how routing works and shows a concept of what a city-wide
          deployment would look like.
        </p>
      </div>
      <div class="timestamp">Concept demo – routing logic (no real trucks yet)</div>
    </div>

    <!-- Section 1: concept + snapshot -->
    <section class="grid">
      <div class="card">
        <div class="card-header">
          <div class="card-title">
            <i class="ph ph-truck"></i>
            <div>
              <div>How Smart Routing Works</div>
              <small class="secondary">From bin sensors to optimized trips.</small>
            </div>
          </div>
          <span class="badge">Dynamic Routes</span>
        </div>

        <p class="secondary">
          Every bin in the network continuously reports its fill level. Before each collection shift,
          SmartWaste builds the shortest route that covers only the bins that are High or Full.
        </p>

        <ul class="list">
          <li>Bins send their fill percentage and status (Empty, Half, High, Full).</li>
          <li>The system filters bins above a threshold in a chosen region.</li>
          <li>A route algorithm orders those bins to minimize distance and time.</li>
          <li>Drivers see the route on a tablet and follow the stops in order.</li>
        </ul>

        <div class="chip-row">
          <span class="chip good">Fewer unnecessary trips</span>
          <span class="chip good">Lower fuel consumption</span>
          <span class="chip">Shorter shift times</span>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <div class="card-title">
            <i class="ph ph-map-trifold"></i>
            <div>
              <div>Example City Snapshot</div>
              <small class="secondary">Mock neighbourhood using our logic.</small>
            </div>
          </div>
          <span class="badge">Region A – morning</span>
        </div>

        <p class="secondary">
          Below is a small demo map showing how different bins in a district affect the route.
          Only the High and Full bins are added to the truck’s path.
        </p>

        <div class="map-wrapper">
          <div class="map-box">
            <div id="city-map"></div>
          </div>
        </div>

        <p class="subtitle">
          In reality we only have three physical bins on the table, but the same data and logic
          can scale to dozens of locations in a real city.
        </p>
      </div>
    </section>

    <!-- Section 2: before vs after -->
    <section class="card">
      <div class="card-header">
        <div class="card-title">
          <i class="ph ph-chart-line-up"></i>
          <div>
            <div>Before vs After Optimization</div>
            <small class="secondary">Traditional route compared to SmartWaste.</small>
          </div>
        </div>
        <span class="badge">Illustrative numbers</span>
      </div>

      <div class="two-cols">
        <div>
          <h3 class="secondary" style="font-weight:600;">Traditional fixed route</h3>
          <p class="subtitle">
            Driver visits every bin on a schedule, even if it’s almost empty.
          </p>
          <div class="main-value">18 bins</div>
          <p class="secondary">visited per loop, but only ~8 bins are actually full.</p>

          <ul class="list">
            <li>Long driving distance even on quiet days.</li>
            <li>Fuel wasted on empty or low-fill bins.</li>
            <li>Full bins can be missed until the next round.</li>
          </ul>
        </div>

        <div>
          <h3 class="secondary" style="font-weight:600;">SmartWaste optimized route</h3>
          <p class="subtitle">
            System only includes bins that are High or Full for that time window.
          </p>
          <div class="main-value">7 bins</div>
          <p class="secondary">actually visited in the same area.</p>

          <ul class="list">
            <li>Up to ~30% less distance for the same service quality.</li>
            <li>Lower CO₂ emissions and less vehicle wear.</li>
            <li>More time available for urgent overflow cases.</li>
          </ul>

          <div class="chip-row">
            <span class="chip good">Fuel saving ~25–35%</span>
            <span class="chip good">Fewer overflowing bins</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 3: timeline + link to prototype -->
    <section class="grid">
      <div class="card">
        <div class="card-header">
          <div class="card-title">
            <i class="ph ph-list-checks"></i>
            <div>
              <div>Sample Optimized Route Timeline</div>
              <small class="secondary">How one truck would follow the smart route.</small>
            </div>
          </div>
          <span class="badge">Truck #2 – morning</span>
        </div>

        <div class="timeline">
          <div class="timeline-step">
            <div class="step-num">1</div>
            <div>Driver starts at depot and receives the list of stops on a tablet.</div>
          </div>
          <div class="timeline-step">
            <div class="step-num">2</div>
            <div>
              First stop is <strong>Bin D2 (100%)</strong> near a residential area – highest overflow risk.
            </div>
          </div>
          <div class="timeline-step">
            <div class="step-num">3</div>
            <div>
              Continue to <strong>B3 (95%)</strong>, then <strong>A2 (72%)</strong>, C4 and F5 following the shortest path.
            </div>
          </div>
          <div class="timeline-step">
            <div class="step-num">4</div>
            <div>
              When bins are collected, their status resets to Empty and they are automatically removed
              from the next route.
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <div class="card-title">
            <i class="ph ph-devices"></i>
            <div>
              <div>Connection to Our Physical Prototype</div>
              <small class="secondary">From 3 demo bins to a full city.</small>
            </div>
          </div>
          <span class="badge">Same data pipeline</span>
        </div>

        <p class="secondary">
          On the table we only have three bins: <strong>Food</strong>, <strong>Recycle</strong>,
          and <strong>General Waste</strong>. The ESP32 measures their fill level and smell and pushes
          it to Firebase. The <em>Live Dashboard</em> page shows this in real time.
        </p>

        <p class="secondary" style="margin-top:10px;">
          In a real deployment, each bin in the city would send the same type of data.
          That data would feed the routing logic described on this page to generate real routes for trucks.
        </p>

        <div class="chip-row">
          <a href="live.html" class="chip good">Open live bin dashboard</a>
          <span class="chip">Uses actual ESP32 sensor data</span>
        </div>
      </div>
    </section>
  </main>

  <script>
    // Navbar scroll effect
    window.addEventListener("scroll", () => {
      const nav = document.getElementById("navbar");
      nav.classList.toggle("scrolled", window.scrollY > 10);
    });

    // Initialize Leaflet map once DOM is ready
    document.addEventListener("DOMContentLoaded", () => {
      // Center roughly on Dubai (just for demo)
      const map = L.map("city-map", {
        zoomControl: false
      }).setView([25.2048, 55.2708], 13);

      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 19,
        attribution: "&copy; OpenStreetMap contributors"
      }).addTo(map);

      // Helper to add colored circle "bin" markers
      function addBin(lat, lng, label, fill, color) {
        const marker = L.circleMarker([lat, lng], {
          radius: 7,
          color,
          fillColor: color,
          fillOpacity: 0.9,
          weight: 2
        }).addTo(map);
        marker.bindPopup(`<strong>${label}</strong><br/>Fill: ${fill}%`);
        return [lat, lng];
      }

      const routePoints = [];

      // Some example bins
      addBin(25.205, 55.26, "Bin A1 (18%)", 18, "#22c55e"); // low
      routePoints.push(
        addBin(25.21, 55.27, "Bin A2 (72%) – High (on route)", 72, "#eab308")
      );
      routePoints.push(
        addBin(25.215, 55.282, "Bin B3 (95%) – Full (top priority)", 95, "#ef4444")
      );
      addBin(25.207, 55.29, "Bin C1 (9%) – Low (skipped)", 9, "#22c55e");
      routePoints.push(
        addBin(25.22, 55.295, "Bin C4 (68%) – High (on route)", 68, "#eab308")
      );
      routePoints.push(
        addBin(25.225, 55.305, "Bin D2 (100%) – Full (must collect)", 100, "#ef4444")
      );

      // Extract lat/lng from nested arrays
      const latlngs = routePoints.map(p => L.latLng(p[0], p[1]));

      // Draw polyline for route (only between high/full bins)
      L.polyline(latlngs, {
        color: "#38bdf8",
        weight: 4,
        opacity: 0.9,
        dashArray: "6 6"
      }).addTo(map);
    });
  </script>
</body>
</html>
